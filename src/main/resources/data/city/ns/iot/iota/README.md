# Client and server for IoTA service

## Overview

This client and server duo allows the provisioning of new IoT devices and the creation of groups.

IoTA stands for "Internet of Things Authority".  Its purpose is to enable new devices to be used on the Agora network,
providing them with such information as certificates and access credentials, in a way that ensures that such
provisioning is only performed by authorised users.

## OpenAPI-based code

The base code in this project was generated by the [oapi-codegen](https://github.com/deepmap/oapi-codegen) utility.
This generates support code in the pkg/iota directory, which is used by both the client and server.  Note that this
code must not be edited manually, as it will be overwritten if and when the YAML specification for the service changes.
See the file api/iota.yaml to see the specification from which this code is generated.

### Generating the Go source files

To regenerate the Go source files, you need oapi-codegen, as mentioned above. Install the binary as described on the
webpage mentioned, ensure that it is in your path. Then navigate to the directory of this `README` and execute the 
commands as follows:

```sh
# Generate data models
oapi-codegen -config api/models/cfg.yaml api/models/models.yaml
# Generate client and server code
oapi-codegen -config api/paths/cfg.yaml api/paths/iota.yaml
oapi-codegen -config api/paths/cfgv1.yaml api/paths/iotav1.yaml
oapi-codegen -config api/paths/cfgv1public.yaml api/paths/iotav1public.yaml
```

This will generate the models, client and server code from the `api` folder and will output the result to `pkg/iota/models/models.gen.go` 
and `pkg/iota/iota.go` file. The generator generates an interface that is implemented by the client and server code, so if
the API has changed, the concrete implementation of this interface will have to be updated manually in order to compile
the client and server code successfully.

## Overview for Setting up for Development

### Setup server
1. Run a script to setup port forwarding so that the local run can talk to dependencies in lab, [by running this script](#script-to-setup-dependencies-for-local-development)
1. Running the server, you can choose between
    1. Setting up in VSCode for debug [Running in debug mode](#running-in-vs-code-in-debugging-mode)
    1. Run the server without IDE [Running the server](#running-the-server)

### Setup Client
* In order to run iotactl tool you will need to grant yourself access. Follow the step in [Granting a user's Woven ID access to the tenant](#granting-a-users-woven-id-access-to-the-tenant).
* Running the tool, see [Running the iotactl utility](#running-the-iotactl-utility)

## Running the client and server

### Running the server

To run the server directly with Go:

```sh
go run cmd/server/main.go
```

To build and run the server using [Bazel](https://github.com/wp-wcm/city/blob/main/docs/development/bazel/README.md):

```sh
bazel run //ns/iot/iota/cmd/server
```

To run with local development environment we can specify flags to override the dependencies and passing in secrets like this
```sh
 go run main.go \
    --agora-environment local \
    --secure-kvs-url http://localhost:15984 \
    --secure-kvs-dbname iot_topology  \
    --broker-url localhost  \
    --broker-management-port 15672  \
    --broker-message-port 5672  \
    --broker-management-user `broker-management-user` \
    --client-id iota  \
    --client-secret `client-secret`  \
    --idp-url https://id.agora-lab.woven-planet.tech  \
    --idp-allowed-clients iota-client  \
    --pki-url https://dev.vault.w3n.io:8200/v1/pki-iota-devices-lab  \
    --pki-token-file /home/<your user>/vault/token  \
    --pki-namespace ns_stargate/ns_dev_wcmshrd_agoraservices  \
    --pki-role iota-devices-2024  \
    --broker-management-password `broker-management-password` \
    --notifier-url http://localhost:18081 \
    --log-collector-url https://log-collector-serverless-lambda.agora-lab.woven-planet.tech/s3/put-presigned-url \
    --k-sink http://localhost:18082 \
    --enable-device-secret \
    --enable_permissions_api \
    --ota-revision-for-local-dev `get-the-latest-value-from-setup-dep-local-env.sh`
 ```

 The user and secret can be retrieve the same was as in [Running in VSCode in debugging mode](#running-in-vs-code-in-debugging-mode)

### Running the iotactl utility

The iotactl utility can be executed either on a desktop PC or on an IoT device, depending on the task to be performed.
To run it directly with Go:

```sh
go run cmd/iotactl/iotactl.go
```

To build and run the iotactl utility using [Bazel](https://github.com/wp-wcm/city/blob/main/docs/development/bazel/README.md):

```sh
bazel run //ns/iot/iota/cmd/iotactl
```

However, running it in this way will only display its help.  There are three commands available on iotactl: _add group_,
_add device_ and _provision_.  As a quickstart, here are examples of the three commands in use:

```sh
iotactl add group <group_name> --tenant <tenant> --username <user> --password <password>
iotactl add device <device_name> --tenant <tenant> --group <group_name> --username <user> --password <password>
iotactl provision <device_name> --provision-secret <secret>
```

You can use the _help_ command to find out more about each one, for example:

```sh
iotactl help add client
```

A good way to keep your CLI command short and iotactl always updated is to create an alias to the artifact generated by bazel in your localhost such as:

```
alias iotactl="/<path to your city repo>/city/bazel-bin/ns/iot/iota/cmd/iotactl/iotactl_/iotactl"
```
This will save some time linking `iotactl` command to the most recently compiled version of your binary.

Another way is to add the iotactl path to $PATH variable. (I need to do this to get shell script to works when executing iotactl command)

```
export PATH=$PATH:/<path to your city repo>/city/bazel-bin/ns/iot/iota/cmd/iotactl/iotactl_
```


## Running in VS Code in debugging mode

For debugging Go code in VS Code, you must have the [Go extension](https://marketplace.visualstudio.com/items?itemName=golang.Go) installed.

In order to debug IoTA without installing all the required services (Keycloak, Vault, etc.) you'll need to paste the JSON content below in your vscode `launch.json` and fill the missing arguments with secrets from the cluster.

```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Launch IoTA Server",
            "type": "go",
            "request": "launch",
            "mode": "auto",
            "program": "iot/iota/cmd/server/main.go",
            "args":[
                "--agora-environment", "local",
                "--broker-url","localhost",
                "--broker-management-port","15672",
                "--broker-message-port", "5672",
                "--broker-management-user","<this value is in the rabbit_default_user username (see below)>",
                "--client-id","iota",
                "--client-secret","<this token is in Keycloak>",
                "--idp-url","https://id.agora-lab.woven-planet.tech",
                "--idp-allowed-clients", "iota-client",
                "--pki-url","https://dev.vault.w3n.io:8200/v1/pki-iota-devices-lab",
                "--pki-token-file","/Users/<your user>/vault/token",
                "--pki-namespace","ns_stargate/ns_dev_wcmshrd_agoraservices",
                "--pki-role", "iota-devices-2024",
                "--secure-kvs-url", "http://localhost:15984",
                "--secure-kvs-dbname", "iot_topology",
                "--notifier-url", "http://localhost:18081",
                "--log-collector-url", "https://log-collector-serverless-lambda.agora-lab.woven-planet.tech/s3/put-presigned-url",
                "--enable-device-secret",
                "--enable_permissions_api"
            ],
            "env": {
                "BROKER_MANAGEMENT_PASSWORD":"<this value is in the rabbit_default_user secret (see below)>",
                "K_SINK": "http://localhost:18082",
                "OTA_REVISION_FOR_LOCAL_DEV" : "<get the latest value from setup-dep-local-env.sh>"
            }
        }
    ]
}
```

_--client-secret_ can be retrieve by login to keyclock admin console and view the credential see, [here](#retrieve-keycloak-client-secret)

_--rabbit_default_user_ can be retrieve from kubectl broker management secret, [here](#retrieve-broker-management-user-and-password)


The default `program` path assumes you are developing in Go using Go Modules, which will require you to open VSCode from the `ns/` path and not the root of the repo to avoid issues with dependencies. If you are using a different configuration and want to launch the server from the repo root, you'll need to adjust the path accordingly to start from `city/`.

### Retrieve broker management user and password
From the Lab cluster

```
kubectl -n iot get secret rabbitmq-default-user -o json | jq '.data | map_values(@base64d)'
```
### Retrieve Keyclock admin access
if you don't have keycloak admin access ask an Agora member to help you out setting your account with such privileges, or alternatively you could retrieve an admin user with

Lab/Dev
```
kubectl -n id get secret credential-keycloak -o jsonpath='{.data.ADMIN_USERNAME}' | base64 -d
kubectl -n id get secret credential-keycloak -o jsonpath='{.data.ADMIN_PASSWORD}' | base64 -d
```

Lab2/Dev2
```
kubectl -n id get secret credential-keycloak-22 -o jsonpath='{.data.ADMIN_USERNAME}' | base64 -d
kubectl -n id get secret credential-keycloak-22 -o jsonpath='{.data.ADMIN_PASSWORD}' | base64 -d
```

Note1: using a shared account is not encouraged and it might be deprecated in the future.
Note2: secret in gen2 has `-22` post-fix.

Once you have your credentials login to https://id.agora-lab.woven-planet.tech/auth.


### Retrieve Keycloak client secret
Once logged in as [admin in Keycloak](#retrieve-keyclock-admin-access) copy the client-secret for the [Lab client](https://id.agora-lab.woven-planet.tech/auth/admin/woven/console/#/realms/woven/clients/iota/credentials) and set it as value for `--client-secret`.

Alternatively, the client secret is copied from client credential and stored in `keycloak-client-secret-iota` secret, it can be obtained by running the below command:

```
kubectl get secret -n iot keycloak-client-secret-iota -o json | jq -r .data.CLIENT_SECRET | base64 -d
```

### Set Vault token
From the `iot` namespace identify the `iota` pod (e.g. by running `kubectl -n iot get pods`).

Using the pod's name (eg. `iota-abc-123`), run:
```
kubectl -n iot exec iota-abc-123 --container vault-agent -- cat /vault/token
```
This will return a token which looks like `hvs.CAESIFOhOUyyd7jlMyhVPlcgw...` used by IoTA to hit Dev Vault endpoints. This is a secret and of course should not be shared outside the Agora Dev Teams. Once the token is obtained, save it in a path in your local and configure the `--pki-token-file` accordingly. A good place is `/Users/<your-user>/vault/token` to keep eveything simple and aligned with what's deployed.

### Port forward to the broker
From the Lab cluster
```
kubectl -n iot port-forward svc/rabbitmq 15672:15672
kubectl -n iot port-forward svc/rabbitmq 1883:1883
```
Note: you can [port forward](https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#port-forward) in one unique line with
```
kubectl -n iot port-forward svc/rabbitmq 1883 15672
```

### Script to setup dependencies for local development
To bring all the dependencies for local development,

```sh
./setup-dep-local-env.sh up
```

To bring down dependencies
```
./setup-dep-local-env.sh down
```

This script retrieves vault token and port forwards RabbitMQ and Secure KVS deployments from the lab and make them available in the ports as required for launching iota in the local development environment.

Make sure your tinyproxy version is >= 1.11.1, as older versions may have issues forwarding requests to Secure KVS.

### Run Secure KVS instance in the local (optional)
Follow the instructions [here](https://github.com/wp-wcm/city/tree/main/ns/secure-kvs/steelcouch#launch-locally-using-docker) to launch Secure KVS in local using docker.

Create `iot_topology` database
```sh
curl -X PUT http://admin:password@localhost:15984/iot_topology
```
Update your .vscode/launch.json file to use `http://admin:password@localhost:15984` as the `secure-kvs-url`.

### Port-forwarding for Secure KVS UI
You can also hit lab or dev Secure KVS for viewing documents using CouchDB’s Futon UI. When doing this, you will access
the unencrypted endpoint on port 5984 instead of the encrypted endpoint. This is because Steelcouch is not exported
from the cluster and means that new records added to CouchDB through the UI will not be encrypted. This results in a mix of encrypted
and unencrypted records in the Secure KVS which can cause problems so please, clean up after yourself by deleting any groups
and devices you have created during testing. Even better, only use the lab cluster and not dev for this.

> **Warning!!! Do NOT edit any documents directly through Futon UI. This will cause the checksum in steelcouch failing and break IoTA.**

If you want to edit the documents directly, please use the [SteelCouch](https://github.com/wp-wcm/city/tree/36933e1f71fa011a20979217ba8ae8b62ab392b1/ns/secure-kvs/steelcouch/docs#launch-locally-using-docker) PUT endpoint at port 15984.

Also remember that external teams' groups and devices might have been registered on dev, so avoid disruptive operations
like group deletions on resources you don't own directly.

```
kubectl -n secure-kvs port-forward svc/agora-kvs-couchdb 5984:5984 # optional, as setup-dep-local-env.sh script already does this.
```
and retrieve the related credentials with
```
kubectl -n secure-kvs get secret agora-kvs-couchdb -o json | jq -r .data.adminPassword | base64 -d
kubectl -n secure-kvs get secret agora-kvs-couchdb -o json | jq -r .data.adminUsername | base64 -d
```

Launch http://localhost:5984/_utils/#login in a browser to open CouchDB’s Futon UI.

### Subscribe/Publish `/reported` and `/delta` topic using MQTT Explorer

An example configuration flow for reporting and subscribing `/reported` and `/delta` using [MQTT Explorer](http://mqtt-explorer.com/) from the local development environment.

- `Host` should be `localhost`.
- `Port` should be 1883 (default).
- `username` and `password` can be obtained from `~/.iota/<cluster>/<tenant>/<group>/<device-name>_broker.json` after `iotactl` provision. `brokerAccessToken` in that file corresponds to `password`.
- `username` must have the tenant name before the username. Ex. `<tenant>:<broker_username>`
- configure topic names for subscribing in `Advanced` configuration. Note: `<tenant>` is not required for MQTT case.
  - ex. `<group>/<device>/shadow/reported`
  - ex. `<group>/<device>/shadow/delta`
- Note: No cert configuration is needed when you access from localhost and port-forward
- After connecting to the server, put `Topic` as `<group>/<device>/shadow/reported` and `PUBLISH` something with JSON, then you can confirm subscribed `<group>/<device>/shadow/reported` or `<group>/<device>/shadow/delta` topics.

### Pointing to local OTA
If you want to point to your locally running OTA server, modify the `k-sink` argument as follows:
```
  --k-sink <local OTA URL>
```

## Accessing RabbitMQ Management UI

* Forward RabbitMQ server port
```sh
kubectl port-forward svc/rabbitmq 15672:15672 -n iot
```
* Open `localhost:15672` from browser
* User and password can be retrieved from
```sh
kubectl get secret rabbitmq-default-user -n iot -o json | jq '.data | map_values(@base64d)'
```

## Tenant management

Groups and devices can be added by anyone with permissions to access Agora Kubernetes clusters. We will use [agoractl-iota](https://github.com/wp-wcm/city/blob/main/ns/agoractl/docs/plugins/01_agoractl_iota.md) to automatically create a new tenant in Keycloak. This [demo](https://drive.google.com/file/d/1R-uKpKOEVbLorXLfyjGOnzBH073YdwgV/view?usp=drive_link) demonstrates how to create and manage the tenant.

Note: There are reports that agoractl does not work on AWS EC2 machine. Please use a local machine instead.

<details>
  <summary>Manual way to create tenant.</summary>

Groups and devices can be added by anyone with a Woven ID that has _tenant_ permissions.  However, there is currently
no way to add those permissions automatically.  There is also currently no way to automatically create a new tenant in
Keycloak.  Both of these actions must be done manually by logging into the [dev](https://id.cityos-dev.woven-planet.tech/auth/) or [lab](https://id.agora-lab.woven-planet.tech/auth/) cluster's Keycloak instance using an account that has admin
privileges.  For security reasons, how to obtain the admin login credentials is not mentioned here.

### Adding a new tenant in Keycloak

Tenants are based on Keycloak _resources_.  Having access to a tenant's resource gives a particular user the rights
to provision devices on that tenant.  To create a new tenant resource in Keycloak:

1) Login to Keycloak and select "Groups" from the "Woven" realm
2) Click the "New" button and and give the group a name in the form of iot-<tenant_name>-group
3) Click the "Save" button
4) Select "Clients" from the "Woven" realm
5) Search for the "iota" client and select it to display its configuration
6) Select the "Authorization" tab; A set of authorization related tabs will appear below it
7) Select the "Resources" tab in the new tabs that have appeared and click the "Create" button
8) Give it a name in the form iot-<tenant_name>-tenant and click the "Save" button
9) Select the "Policies" tab and in the "Create Policy..." dropdown select "Group"
10) Give it a name in the form of iot-<tenant_name>-policy and add the iot-<tenant_name>-group from the Groups list
11) Click the "Save" button
12) Select the "Permissions" tab and in the "Create Permission..." dropdown select "Resource-Based"
13) Give it a name in the form of iot-<tenant_name>-permission
14) Next to the "Resources" field, click the "Select a resource..." dropdown and search for the tenant name from step #5.
15) Next to the "Apply Policy" field, click the "Select existing policy..." dropdown and search for the policy name from step #7.
16) Click the "Save" button

At this point, you have created a resource for the desired <tenant_name> and have created an access policy and
permission for granting access to that resource, as well as a group associated with the resource.

### Adding a new vhost in RabbitMQ

While the new tenant is now available for use via Keycloak, it must also be created in RabbitMQ, where it is called a
"vhost".  To create a new vhost in RabbitMQ we use the topology operator as follows:

1) Add a vhost to the bottom of the [vhosts](https://github.com/wp-wcm/city/blob/392bcc3510ec8ea8b474d1c1fecc344df52a81e2/infrastructure/k8s/dev/iot/rabbitmq-vhosts.yaml#L71) file

```
apiVersion: rabbitmq.com/v1beta1
kind: Vhost
metadata:
  name: <namespace>-vhost
  namespace: iot
spec:
  name: <namespace>
  rabbitmqClusterReference:
    name: rabbitmq
```

2) Open a PR and once merged you should see the vhost appear in the [management console](#accessing-rabbitmq-management-ui). (example [PR](https://github.com/wp-wcm/city/pull/3614))

Without this step, a user will be able to create groups and devices in their tenant, but the provisioning step will fail
and they won't be able to send or receive messages via RabbitMQ.

### Granting a user's Woven ID access to the tenant

Access is granted to the resource created above by adding the user's Woven ID account to the group that was created.  To
do this:

1) Login to [lab](https://id.agora-lab.woven-planet.tech/auth/) cluster's Keycloak instance  with username and password from [here](#retrieve-keyclock-admin-access)
2) Select "Users" from the "Woven" realm
3) Search for the user (or add user) for which access to is be granted and select it to display its configuration
4) Select the "Groups" tab
5) Select the group created in the above set of steps from the list on the right.  It will be named iot-<tenant_name>-group and click the "Join" button

Done!  The user with the selected Woven ID can now use his or her Keycloak user name and password to create and delete
groups and devices under <tenant_name> (but not under other tenants).  To enable access to other tenants, simply add
the desired tenant's group to the user's list of groups.  To revoke access to the user, remove the appropriate
tenant's group from the user's Woven ID.

</details>

## Generating mocks
We use [mockery](https://vektra.github.io/mockery/latest/) to generate mocks for our tests.

To generate mocks:
```
go generate ./...
```

Note that you may have to add a `go:generate` comment to the interface you want to mock.

## Running tests

As for all go projects, tests can be run with the following command:

```sh
go test ./...
```

To run the tests using Bazel:

```sh
bazel test //ns/iot/iota/...
```

This will execute all unit and integration tests in the IoTA directory. You can run just the tests for a specific
component of IoTA in the following way:

```sh
go test ./internal/server
```

Replace _./internal/server_ with the path to the component you would like to test.

Or using Bazel:

```sh
bazel test //ns/iot/iota/internal/server/...
```

To generate coverage statistics and a nice HTML page to display them, run the tests like this:

```sh
go test ./... -coverprofile=results.out
go tool cover -html=results.out
```

This enables us to see what the test coverage percentage is and to easily see which parts of the code are covered
(in green) or not covered (in red).

## Test common usecases

### Creating iotactl configuration file

Run
```sh
iotactl init context
```
to create the configuration file as ```~/.iota/lab.toml``` with the following contents

```
client-id = 'iota-client'
idp-url = 'https://id.agora-lab.woven-planet.tech'
service-url = 'https://iot.agora-lab.woven-planet.tech'
tenant = 'test'
```

### Run test script

Run the below script to test all common use cases of IoTA. (Note: you will need to install [mosquitto](https://mosquitto.org/download/))

You must be inside the `tests` directory in order for the tests to work correctly.
```sh
cd tests
bash -x iota-test.sh local|lab|dev
```

If you are running tests against `local`, you will need to update the `baseCertDomain`. See [here](https://confluence.tri-ad.tech/display/IOTA/%60Invalid+CSR+Tenant%60+when+running+%60iota-test.sh%60+on+local+server).

## Building and publishing a new version of iotactl

The `iotactl` binaries are built automatically on CI/CD every time a PR
affecting the application's code is merged. These builds are based on the
`push_iotactl*` Bazel rules, which are defined in the following file:
`ns/iot/iota/cmd/iotactl/BUILD`.

Once the CI/CD build finishes, you should be able to find the newly
generated binaries in the following directory of the Artifactory:
<https://artifactory-ha.tri-ad.tech/ui/native/wcm-cityos/ns/iot/iota/cmd/iotactl/>.

# Device log consumer
Device log consumer is another iota app that when run, will consume the logs from devices via MQTT message.
It is implemented using a watcher package that uses AMQP. The log will pass the log to log-collector serverless for
further transformation.

## Development
First, run a script to setup port forwarding
```sh
./setup-dep-local-env.sh up
```

Then run debug the log consumer by adding this to `launch.json` replacing the user and secret.

```
 {
            "name": "Launch Device Log Listener",
            "type": "go",
            "request": "launch",
            "mode": "auto",
            "program": "iot/iota/cmd/device-log-consumer/main.go",
            "args":[
                "--broker-url","localhost",
                "--broker-management-port","15672",
                "--broker-message-port", "5672",
                "--broker-management-user","<broker-user>",
                "--collector-url","https://log-collector-serverless-lambda.agora-lab.woven-planet.tech/iota",
            ],
            "env": {
                "BROKER_MANAGEMENT_PASSWORD":"<broker-secret>",
            }
        },
```

or run it with go
```sh
go run main.go \
--broker-url localhost \
--broker-management-port 15672 \
--broker-message-port 5672 \
--broker-management-user <broker-user> \
--broker-management-password <broker-secret> \
--collector-url  https://log-collector-serverless-lambda.agora-lab.woven-planet.tech/iota
```


 The broker-use and broker secret can be retreived from rabbit secret [here](#retrieve-broker-management-user-and-password)

Then you can send the MQTT message using [MQTT Explorer](http://mqtt-explorer.com/) from the local development environment.
with the topic `<group>/<device>/logs`

see how to setup the MQTT explorer [here](#subscribepublish-reported-and-delta-topic-using-mqtt-explorer)


## Running manual end-to-end test against lab/dev
Prerequisite: [Onboard your test IoT Device on Agora](docs/index.md#onboard-your-iot-device-on-agora)

You can run a [demo script](../demo/devicelog/README.md) against the testing environment (dev/lab/lab2).

Verify that log is posted in Grafana
* [LAB](https://observability.agora-lab.woven-planet.tech/grafana/d/569ef518df53e079e43c60b6f2fa95b00fd20b0b/log-collector-logs-per-tenant?orgId=1&refresh=5s)
* [DEV](https://observability.cityos-dev.woven-planet.tech/grafana/d/569ef518df53e079e43c60b6f2fa95b00fd20b0b/log-collector-logs-per-tenant?orgId=1&refresh=5s)

## Manually testing the OTA Upload endpoint
Assuming you have both IoTA & OTA running, you can manually test the upload endpoint by using the following `cURL` command:
```shell
curl -F file=@<local-file.txt> http://localhost:8081/tenants/<tenant>/groups/<group>>/releases/<release-id> -H 'Authorization: Bearer '"<token>"'' -F tags=deprecated,old
```

e.g. for the `test` tenant, a group named `rp-test-ota`, and calling this from a directory with a file named `sample.txt` this would look like:
```shell
curl -F file=@sample.txt http://localhost:8081/tenants/test/groups/rp-test-ota/releases/my-super-cool-release -H 'Authorization: Bearer '"<token>"'' -F tags=deprecated,old
```

You can also generate a JWT for Lab using an alias:
```shell
JWTLab='curl -s -X POST https://id.agora-lab.woven-planet.tech/auth/realms/woven/protocol/openid-connect/token -H '\''Authorization: Basic'\'' -H '\''Content-Type: application/x-www-form-urlencoded'\'' -d '\''grant_type=password&username='\''<username>'\''&password='\''<password>'\''&client_id='\''iota-client'\''&scope=openid'\'' | jq -r .access_token'
```

Since this JWT is very short-lived, it's usually best to embed the call to it in your `cURL` command, like so:
```shell
curl -F file=@sample.txt http://localhost:8081/tenants/test/groups/rp-test-ota/releases/test-upload-from-my-local-with-tags -H 'Authorization: Bearer '"$(JWTLab)"'' -F tags=deprecated,old
```
