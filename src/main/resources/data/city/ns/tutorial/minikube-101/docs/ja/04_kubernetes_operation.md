# Step 4: Reaching the application

この段階で、アプリケーションをデプロイするための全てのピースが揃っていますので、アプリケーションにアクセスすることができます。
ここでは次のステップとして、実際にサービスにアクセスし、会話をしてみます。

## Talking to Services and Pods in Minikube

サービスやポッドと話す方法はいくつかありますが、このチュートリアルではポートフォワードという手法を用いることにします。
ポートフォワードを使用すると、外部からクラスターへのトンネルを作成することができ、クラスター内部に接続することができるようになります。

では試してみましょう。まず、設定ファイルに従って、サービスをポート80で待ち受けさせ、ポッドも同じく80をリッスンさせます。
これは、アプリケーションと通信するには、サービスのポート80にポートフォワードすれば良いということになります。ローカル側に関しては8888ポートを使っていますが、他の好きなポート番号を使用して構いません。

```shell
$ kubectl port-forward service/landing-page -n landing-page 8888:80
Forwarding from 127.0.0.1:8888 -> 80
Forwarding from [::1]:8888 -> 80
```

これでサービスとの接続は完了です。これでトラフィックを送信できるようになりました。
このアプリケーションはシンプルな Nginx サーバーで、簡素なHTTPページをホストしています。それでは curl コマンドを実行してみましょう。

```shell
$ curl http://localhost:8888

<!doctype html>
  <html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CityOS</title>
  </head>
  <body>
    <h2>Welcome to CityOS</h2>
  </body>
</html>
```

やりました！アプリケーションからの応答がありました!
ポッドのログを見てもこれを確認できます。


```shell
$ kubectl logs <name of the pod> -n landing-page
. . .
172.17.0.1 - - [07/Jul/2022:22:58:33 +0000] "GET / HTTP/1.1" 200 165 "-" "kube-probe/1.24" "-"
172.17.0.1 - - [07/Jul/2022:22:58:43 +0000] "GET / HTTP/1.1" 200 165 "-" "kube-probe/1.24" "-"
127.0.0.1 - - [07/Jul/2022:22:58:48 +0000] "GET / HTTP/1.1" 200 165 "-" "curl/7.79.1" "-"
172.17.0.1 - - [07/Jul/2022:22:58:53 +0000] "GET / HTTP/1.1" 200 165 "-" "kube-probe/1.24" "-"
. . .
```

localhost (127.0.0.1) から `curl` コマンド経由でアクセスがあり、200レスポンスを返したことが分かります。

## Congratulations

これで、最初のKubernetesサービスが完成し、リクエストを送信して応答を取得できるようになりました。
このチュートリアルでは、以下のことを学びました。

* ネームスペースを使用してアプリケーションを整理する方法
* Serviceを使用してアプリケーションを一つのDNSの下に設定する方法
* Deploymentを使用してアプリケーションをセットアップする方法
* minikubeでアプリケーションにアクセスする方法
* 基本的なkubectlコマンドを使用してアプリケーションとその状態を確認する方法
