# Secure KVS deployment manifests

The folder includes manifests for the Secure KVS deployment.

## Overview

The manifests are intended to support the migration of the Secure KVS deployment to use the CouchDB cluster managed by the CouchDBoperator.

Here is the list of what the manifests handle.

- Deploy a new CouchDB cluster managed by the operator.
- Deploy a new Steelcouch pointing to the new CouchDB cluster.

## How to re-generate manifests

The manifests were generated by [the secure-kvs Helm chart](/infrastructure/helm/secure-kvs).

Here is the list of the files under this folder.

| File                                               | Notes                                                                         |
| -------------------------------------------------- | ----------------------------------------------------------------------------- |
| [generate\_manifests.sh](./generate_manifests.sh)  | A script to generate manifests                                                |
| [secure-kvs.values.yaml](./secure-kvs.values.yaml) | `values.yaml` for the Helm chart                                              |
| [README.md](./README.md)                           | This file                                                                     |
| [manifests](./manifests)                           | Generated manifest files by [generate\_manifests.sh](./generate_manifests.sh) |

You can re-generate the manifests by executing [generate\_manifests.sh](./generate_manifests.sh) from the repository root directory. The script requires:
-  [helm](https://helm.sh/docs/intro/install/)
-  [kubectl slice](https://github.com/patrickdappollonio/kubectl-slice)
-  [yq](https://github.com/mikefarah/yq)
-  [yamlfmt](https://github.com/google/yamlfmt)
-  [kustomize](https://kubectl.docs.kubernetes.io/installation/kustomize/)

## Difference as compared to 0.2.0
- Toggled the flag to create steelcouch service account.
